##Readme file for reanalysis of public data to determine primer bias in upper gential tract microbiome studies. Each individual analysis will describe the methods use and then go into detail on the scripts within each directory.

1. Taxonomic classification of next generation sequencing of original dataset
Sequence clustering and operational taxonomic unit (OTU) selection was performed using a modified version of CD-HIT-OTU-454 which does not remove singleton clusters (29). Taxonomy was assigned to representative sequences by comparison to the latest build of the Greengenes database (https://greengenes.secondgenome.com/) using BLAST (https://blast.ncbi.nlm.nih.gov/Blast.cgi), and OTU tables were constructed from the output using a custom Perl script(30). 

2. Phylogenetic analysis
Was completed in GUI software (Geneious and MEGA) not by coding. 
Full-length 16S rRNA sequences for Lactobacillus spp. (accession numbers: AB680529.1, AB690249.1, AB668940.1.1, AB008203.1.1, AB425941.1.1, AB008206.1, AF243169.1, AF243167.1, CP018809.253324, CP018809.1516019, CP018809.1347636, CP018809.500868, AB547127.1, AB517146.1, AB932527.1, AB008209.1, HZ485829.7, LG085736.7 LF134126.7, LG104504.7), Pediococcus pentosaceus (accession numbers: AB018215.1 and AB362987.1), and Bacillus subtilis (accession numbers: AP012496.9810 and AP012496.30276) were downloaded from the SILVA database using the web interface (www.arb-silva.de). Sequences were aligned using ClustalW (31) with the default settings. MEGA7 (32) was used to generate the best-known maximum likelihood (ML) tree using a Jukes-Cantor model and 1000 bootstrapping iterations. The ML tree was visualised and edited in FigTree  (http://tree.bio.ed.ac.uk ) and Adobe Illustrator.

To generate the phylogenetic trees for the specific regions,  V5-V8 region phylogenetic tree the same full-length 16S rRNA sequences from above were imported into Geneious (https://www.geneious.com/) along with two Escherichia coli sequences downloaded from SILVA (https://www.arb-silva.de/) (accession number: AB045730.1 and AB045731.1). Sequences were aligned using standard Geneious alignment and trimmed to include the variable specific variable regions V5-V8 (nucleotides 751 – 1300 for the E.coli sequence).(V1-V2, V1-V3, V3-V4, V3-V4. V4 and V5-V8) using the E.coli sequences. Trimmed sequences were then aligned using ClustalW with default settings and imported into MEGA7 and a trees was were constructed and edited same as above. 

3. Hierarchial clustering
A dissimilarity matrix was generated based on the relative abundances of Lactobacillus spp. in the pyrosequenced and qPCR analysed samples using the vegdist function in the vegan package in R  (https://www.r-project.org/) with the Bray-Curtis dissimilarity metric (33). Hierarchical clustering was performed using the hclust function in R with ‘average’ linkage (UPGMA) (34). Clustering and relative abundances were visualized in a heatmap with associated dendrogram using the heatmap.2 function from the R package ggplots (35). 

4. Reanalysis of publicly available endometrium datasets
Four datasets (Table 2) were re-analysed using the standard QIIME2 (http://qiime.org/) data analysis pipeline to determine Lactobacillus abundance using a standard full-length taxonomic classifier. 
The datasets used were PRJNA329174, PRJNA546137, PRJEB18626, PRJNA543861.
The raw reads were downloaded from NCBI using fastq-dump and, if paired end, reads were split. Raw data was then uploaded into QIIME2 using standard parameters and quality control checks were run. Based on the QC data, denoising and trimming was completed with custom values for each dataset using the DADA2 algorithm within QIIME2. The denoised DNA sequences and corresponding biom table were downloaded from QIIME2 and used in R with a full length taxonomic classifer and the DADA2 software. Custom R scripts were used to identify the number of sequences that had been classifed as a Lactobacillus species from the full dataset.   

Each primer pair was used to create in silico 16S rRNA gene read libraries using custom databases with the five Lactobacillus species of interest (downloaded from SILVA) using Grinder (https://sourceforge.net/projects/grinder/), a sequencing simulator. 

Custom scripts in R were used to determine the sequence coverage (the percentages of reads amplified by the primers) between different primer pairs. Each primer pair was used with the custom database for all Lactobacillus species (n=1371) to create fastq files with approximately 20,000 sequencing reads. The proportion of reads belonging to each species was identified for each primer and compared to the predicted amplification from the unbiased total dataset. These values correspond to the first column (number of reads) and second column (percentage of reads for each species) within the results table for each primer pair. The proportion of species that was expected to be amplified was compared to the actual amplification predicted by each primer set using custom scripts in R. 

Primer pairs were also used to in silico amplify the human genome to predict low biomass contamination by host DNA using MFEprimer software (https://www.mfeprimer.com/).
